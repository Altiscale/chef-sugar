<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Chef Sugar by sethvargo</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Chef Sugar</h1>
        <p>Chef Sugar is a Gem &amp; Chef Recipe that includes series of helpful sugar of the Chef core and other resources to make a cleaner, more lean recipd DSL, enforce DRY principles, and make writing Chef recipes an awesome experience!</p>

        <p class="view"><a href="https://github.com/sethvargo/chef-sugar">View the Project on GitHub <small>sethvargo/chef-sugar</small></a></p>


        <ul>
          <li><a href="https://github.com/sethvargo/chef-sugar/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/sethvargo/chef-sugar/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/sethvargo/chef-sugar">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="chefsugar" class="anchor" href="#chefsugar" aria-hidden="true"><span class="octicon octicon-link"></span></a>Chef::Sugar</h1>

<p><a href="https://rubygems.org/gems/chef-sugar"><img src="http://img.shields.io/gem/v/chef-sugar.svg" alt="Gem Version"></a>
<a href="http://travis-ci.org/sethvargo/chef-suguar"><img src="http://img.shields.io/travis/sethvargo/chef-sugar.svg" alt="Build Status"></a>
<a href="https://gemnasium.com/sethvargo/chef-sugar"><img src="http://img.shields.io/gemnasium/sethvargo/chef-sugar.svg" alt="Dependency Status"></a>
<a href="https://codeclimate.com/github/sethvargo/chef-sugar"><img src="http://img.shields.io/codeclimate/github/sethvargo/chef-sugar.svg" alt="Code Climate"></a></p>

<p>Chef Sugar is a Gem &amp; Chef Recipe that includes series of helpful sugar of the Chef core and other resources to make a cleaner, more lean recipe DSL, enforce DRY principles, and make writing Chef recipes an awesome experience!</p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>If you want to develop/hack on chef-sugar, please see the Contributing.md.</p>

<p>If you are using Berkshelf, add <code>chef-sugar</code> to your <code>Berksfile</code>:</p>

<div class="highlight highlight-ruby"><pre>cookbook <span class="pl-s1"><span class="pl-pds">'</span>chef-sugar<span class="pl-pds">'</span></span></pre></div>

<p>Otherwise, you can use <code>knife</code> or download the tarball directly from the community site:</p>

<div class="highlight highlight-ruby"><pre>knife cookbook site install chef<span class="pl-ko">-</span>sugar</pre></div>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h2>

<p>In order to use Chef Sugar in your Chef Recipes, you'll first need to include it:</p>

<div class="highlight highlight-ruby"><pre>include_recipe <span class="pl-s1"><span class="pl-pds">'</span>chef-sugar::default<span class="pl-pds">'</span></span></pre></div>

<p>Alternatively you can put it in a base role or recipe and it will be included subsequently.</p>

<p>Requiring the Chef Sugar Gem will automatically extend the Recipe DSL, <code>Chef::Resource</code>, and <code>Chef::Provider</code> with helpful convenience methods.</p>

<h3>
<a id="module-method" class="anchor" href="#module-method" aria-hidden="true"><span class="octicon octicon-link"></span></a>Module Method</h3>

<p>If you are working outside of the Recipe DSL, you can use the module methods instead of the Recipe DSL. In general, the module methods have the same name as their Recipe-DSL counterparts, but require the node object as a parameter. For example:</p>

<p>In a Recipe:</p>

<div class="highlight highlight-ruby"><pre><span class="pl-c"><span class="pl-pdc">#</span> cookbook/recipes/default.rb</span>
do_something <span class="pl-k">if</span> windows?</pre></div>

<p>In a Library as a singleton:</p>

<div class="highlight highlight-ruby"><pre><span class="pl-c"><span class="pl-pdc">#</span> cookbook/libraries/default.rb</span>
<span class="pl-k">def</span> <span class="pl-enf">only_on_windows</span>(<span class="pl-s">&amp;</span><span class="pl-vpf">block</span>)
  <span class="pl-k">yield</span> <span class="pl-k">if</span> <span class="pl-sc">Chef</span>::<span class="pl-sc">Sugar</span>::<span class="pl-sc">PlatformFamily</span>.windows?(<span class="pl-v"><span class="pl-pdv">@</span>node</span>)
<span class="pl-k">end</span></pre></div>

<p>In a Library as a Mixin:</p>

<div class="highlight highlight-ruby"><pre><span class="pl-c"><span class="pl-pdc">#</span> cookbook/libraries/default.rb</span>
<span class="pl-kos">include</span> <span class="pl-sc">Chef</span>::<span class="pl-sc">Sugar</span>::<span class="pl-v">PlatformFamily</span>

<span class="pl-k">def</span> <span class="pl-enf">only_on_windows</span>(<span class="pl-s">&amp;</span><span class="pl-vpf">block</span>)
  <span class="pl-k">yield</span> <span class="pl-k">if</span> windows?(<span class="pl-v"><span class="pl-pdv">@</span>node</span>)
<span class="pl-k">end</span></pre></div>

<h2>
<a id="api" class="anchor" href="#api" aria-hidden="true"><span class="octicon octicon-link"></span></a>API</h2>

<p><strong>Note:</strong> For the most extensive API documentation, please see the YARD documentation.</p>

<h3>
<a id="architecture" class="anchor" href="#architecture" aria-hidden="true"><span class="octicon octicon-link"></span></a>Architecture</h3>

<p><strong>Note:</strong> Some of the architecture commands begin with an underscore (<code>_</code>) because Ruby does not permit methods to start with a numeric.</p>

<ul>
<li><code>_64_bit?</code></li>
<li><code>_32_bit?</code></li>
</ul>

<h4>
<a id="examples" class="anchor" href="#examples" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h4>

<div class="highlight highlight-ruby"><pre>execute <span class="pl-s1"><span class="pl-pds">'</span>build[my binary]<span class="pl-pds">'</span></span> <span class="pl-k">do</span>
  command <span class="pl-s1"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>
  not_if  { _64_bit? }
<span class="pl-k">end</span></pre></div>

<h3>
<a id="cloud" class="anchor" href="#cloud" aria-hidden="true"><span class="octicon octicon-link"></span></a>Cloud</h3>

<ul>
<li><code>azure?</code></li>
<li><code>cloud?</code></li>
<li><code>ec2?</code></li>
<li><code>eucalyptus?</code></li>
<li><code>gce?</code></li>
<li><code>linode?</code></li>
<li><code>openstack?</code></li>
<li><code>cloudstack?</code></li>
<li><code>rackspace?</code></li>
</ul>

<h4>
<a id="examples-1" class="anchor" href="#examples-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h4>

<div class="highlight highlight-ruby"><pre>template <span class="pl-s1"><span class="pl-pds">'</span>/tmp/config<span class="pl-pds">'</span></span> <span class="pl-k">do</span>
  variables(
    <span class="pl-c"><span class="pl-pdc">#</span> See also: best_ip_for</span>
    <span class="pl-cos">ipaddress<span class="pl-pdc1">:</span></span> cloud? <span class="pl-ko">?</span> node[<span class="pl-s1"><span class="pl-pds">'</span>local_ipv4<span class="pl-pds">'</span></span>] : node[<span class="pl-s1"><span class="pl-pds">'</span>public_ipv4<span class="pl-pds">'</span></span>]
  )
<span class="pl-k">end</span></pre></div>

<h3>
<a id="core-extensions" class="anchor" href="#core-extensions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Core Extensions</h3>

<p><strong>Note:</strong> Core extensions are <strong>not</strong> included by default. You must require the <code>chef/sugar/core_extensions</code> module manually to gain access to these APIs:</p>

<div class="highlight highlight-ruby"><pre><span class="pl-mr"><span class="pl-kos">require</span> <span class="pl-s1"><span class="pl-pds">'</span>chef/sugar/core_extensions<span class="pl-pds">'</span></span></span></pre></div>

<ul>
<li><code>String#satisfies?</code></li>
<li><code>String#satisfied_by?</code></li>
<li><code>Array#satisfied_by?</code></li>
<li><code>Object#blank?</code></li>
</ul>

<h4>
<a id="examples-2" class="anchor" href="#examples-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h4>

<div class="highlight highlight-ruby"><pre><span class="pl-c"><span class="pl-pdc">#</span> Checking version constraints</span>
<span class="pl-s1"><span class="pl-pds">'</span>1.0.0<span class="pl-pds">'</span></span>.satisfies?(<span class="pl-s1"><span class="pl-pds">'</span>~&gt; 1.0<span class="pl-pds">'</span></span>) <span class="pl-c"><span class="pl-pdc">#</span>=&gt; true</span>
<span class="pl-s1"><span class="pl-pds">'</span>~&gt; 1.0<span class="pl-pds">'</span></span>.satisfied_by?(<span class="pl-s1"><span class="pl-pds">'</span>1.0<span class="pl-pds">'</span></span>) <span class="pl-c"><span class="pl-pdc">#</span>=&gt; true</span></pre></div>

<div class="highlight highlight-ruby"><pre><span class="pl-c"><span class="pl-pdc">#</span> Check for an object's presence</span>
<span class="pl-s1"><span class="pl-pds">'</span><span class="pl-pds">'</span></span>.blank? <span class="pl-c"><span class="pl-pdc">#</span>=&gt; true</span>
[<span class="pl-s1"><span class="pl-pds">'</span>hello<span class="pl-pds">'</span></span>].blank? <span class="pl-c"><span class="pl-pdc">#</span>=&gt; false</span></pre></div>

<h3>
<a id="data-bag" class="anchor" href="#data-bag" aria-hidden="true"><span class="octicon octicon-link"></span></a>Data Bag</h3>

<ul>
<li>
<code>encrypted_data_bag_item</code> - a handy DSL method for loading encrypted data bag items the same way you load a regular data bag item; this requires <code>Chef::Config[:encrypted_data_bag_secret]</code> is set!</li>
<li>
<code>encrypted_data_bag_item_for_environment</code> - find the data bag entry for the current node's Chef environment.</li>
</ul>

<h4>
<a id="examples-3" class="anchor" href="#examples-3" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h4>

<div class="highlight highlight-ruby"><pre>encrypted_data_bag_item(<span class="pl-s1"><span class="pl-pds">'</span>accounts<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>hipchat<span class="pl-pds">'</span></span>)</pre></div>

<div class="highlight highlight-ruby"><pre>encrypted_data_bag_item_for_environment(<span class="pl-s1"><span class="pl-pds">'</span>accounts<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>github<span class="pl-pds">'</span></span>)</pre></div>

<h3>
<a id="docker" class="anchor" href="#docker" aria-hidden="true"><span class="octicon octicon-link"></span></a>Docker</h3>

<p>Chef Sugar looks for hints to see if the node being converged is a Docker container. When <a href="https://github.com/opscode/ohai/pull/428">Ohai supports checking other nodes</a>, Chef Sugar will automatically pick up the information.</p>

<ul>
<li><code>docker?</code></li>
</ul>

<h4>
<a id="examples-4" class="anchor" href="#examples-4" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h4>

<div class="highlight highlight-ruby"><pre>template <span class="pl-s1"><span class="pl-pds">'</span>/runme<span class="pl-pds">'</span></span> <span class="pl-k">do</span>
  only_if { docker?(node) }
<span class="pl-k">end</span></pre></div>

<h3>
<a id="attributes" class="anchor" href="#attributes" aria-hidden="true"><span class="octicon octicon-link"></span></a>Attributes</h3>

<p>Chef Sugar adds more Chef-like DSL to attribute definitions. Instead of using the Ruby hash syntax, you can define attributes using nested namespaces. This DSL may be more friendly to non-Ruby developers. It can safely be mixed-and-matched with the standard syntax.</p>

<div class="highlight highlight-ruby"><pre><span class="pl-c"><span class="pl-pdc">#</span> This is functionally the same as default['apache2']['config']['root'] = '/var/www'</span>
namespace <span class="pl-s1"><span class="pl-pds">'</span>apache2<span class="pl-pds">'</span></span> <span class="pl-k">do</span>
  namespace <span class="pl-s1"><span class="pl-pds">'</span>config<span class="pl-pds">'</span></span> <span class="pl-k">do</span>
    root <span class="pl-s1"><span class="pl-pds">'</span>/var/www<span class="pl-pds">'</span></span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div>

<div class="highlight highlight-ruby"><pre><span class="pl-c"><span class="pl-pdc">#</span> Specify multiple keys instead of nesting namespaces</span>
namespace <span class="pl-s1"><span class="pl-pds">'</span>apache2<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>config<span class="pl-pds">'</span></span> <span class="pl-k">do</span>
  root <span class="pl-s1"><span class="pl-pds">'</span>/var/www<span class="pl-pds">'</span></span>
<span class="pl-k">end</span></pre></div>

<div class="highlight highlight-ruby"><pre><span class="pl-c"><span class="pl-pdc">#</span> Specify different nested precedence levels</span>
namespace <span class="pl-s1"><span class="pl-pds">'</span>apache2<span class="pl-pds">'</span></span>, <span class="pl-cos">precedence<span class="pl-pdc1">:</span></span> normal <span class="pl-k">do</span>
  namespace <span class="pl-s1"><span class="pl-pds">'</span>config<span class="pl-pds">'</span></span>, <span class="pl-cos">precedence<span class="pl-pdc1">:</span></span> override <span class="pl-k">do</span>
    root <span class="pl-s1"><span class="pl-pds">'</span>/var/www<span class="pl-pds">'</span></span> <span class="pl-c"><span class="pl-pdc">#</span>=&gt; override['apache2']['config']['root'] = '/var/www'</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div>

<h3>
<a id="constraints" class="anchor" href="#constraints" aria-hidden="true"><span class="octicon octicon-link"></span></a>Constraints</h3>

<ul>
<li>
<code>constraints</code> - create a new constraint (or requirement) that can be used to test version validations.</li>
<li>
<code>chef_version</code> - (DSL only) a wrapper for <code>version(Chef::VERSION)</code>
</li>
<li>
<code>version</code> - create a new version that can be used to test constraint validation.</li>
</ul>

<h4>
<a id="examples-5" class="anchor" href="#examples-5" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h4>

<div class="highlight highlight-ruby"><pre><span class="pl-c"><span class="pl-pdc">#</span> Check if a version is satisfied by a constraint</span>
version(<span class="pl-s1"><span class="pl-pds">'</span>1.2.3<span class="pl-pds">'</span></span>).satisfies?(<span class="pl-s1"><span class="pl-pds">'</span>~&gt; 1.2.0<span class="pl-pds">'</span></span>)</pre></div>

<div class="highlight highlight-ruby"><pre><span class="pl-c"><span class="pl-pdc">#</span> Check if a constraint is satisfied by a version</span>
constraint(<span class="pl-s1"><span class="pl-pds">'</span>~&gt; 1.2.0<span class="pl-pds">'</span></span>).satisfied_by?(<span class="pl-s1"><span class="pl-pds">'</span>1.2.3<span class="pl-pds">'</span></span>)</pre></div>

<div class="highlight highlight-ruby"><pre><span class="pl-c"><span class="pl-pdc">#</span> Support multiple constraints</span>
version(<span class="pl-s1"><span class="pl-pds">'</span>1.2.3<span class="pl-pds">'</span></span>).satisfies?(<span class="pl-s1"><span class="pl-pds">'</span>&gt; 1.2<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>&lt; 2.0<span class="pl-pds">'</span></span>)
constraint(<span class="pl-s1"><span class="pl-pds">'</span>&gt; 1.2<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>&lt; 2.0<span class="pl-pds">'</span></span>).satisfied_by?(<span class="pl-s1"><span class="pl-pds">'</span>1.2.3<span class="pl-pds">'</span></span>)</pre></div>

<div class="highlight highlight-ruby"><pre><span class="pl-c"><span class="pl-pdc">#</span> Only perform an operation if Chef is at a certain version</span>
package <span class="pl-s1"><span class="pl-pds">'</span>apache2<span class="pl-pds">'</span></span> <span class="pl-k">do</span>
  not_if { chef_version.satisfies?(<span class="pl-s1"><span class="pl-pds">'</span>~&gt; 11.0<span class="pl-pds">'</span></span>) } <span class="pl-c"><span class="pl-pdc">#</span> Ignore Chef 11</span>
<span class="pl-k">end</span></pre></div>

<h3>
<a id="kernel" class="anchor" href="#kernel" aria-hidden="true"><span class="octicon octicon-link"></span></a>Kernel</h3>

<ul>
<li>
<p><code>require_chef_gem</code> - "safely" require a gem. Loading a gem with Chef is sometimes difficult and confusing. The errors that Chef produces are also sometimes not very intuitive. In the event you require a gem to exist on the system, you can use <code>require_chef_gem</code>, which will attempt to require the gem and then produce helpful output if the gem is not installed:</p>

<pre><code>Chef could not load the gem `#{name}'! You may need to install the gem
manually with `gem install #{name}', or include a recipe before you can
use this resource. Please consult the documentation for this cookbook
for proper usage.
</code></pre>
</li>
</ul>

<h4>
<a id="examples-6" class="anchor" href="#examples-6" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h4>

<div class="highlight highlight-ruby"><pre><span class="pl-c"><span class="pl-pdc">#</span> LWRP</span>
require_chef_gem <span class="pl-s1"><span class="pl-pds">'</span>pry<span class="pl-pds">'</span></span></pre></div>

<div class="highlight highlight-ruby"><pre><span class="pl-k">class</span> <span class="pl-entc">Chef</span>
  <span class="pl-k">class</span> <span class="pl-entc">Provider</span>
    <span class="pl-k">class</span> <span class="pl-entc">MyProvider</span> <span class="pl-ko">&gt;</span> <span class="pl-v">Provider</span>
      require_chef_gem <span class="pl-s1"><span class="pl-pds">'</span>pry<span class="pl-pds">'</span></span>
    <span class="pl-k">end</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div>

<h3>
<a id="ip" class="anchor" href="#ip" aria-hidden="true"><span class="octicon octicon-link"></span></a>IP</h3>

<ul>
<li>
<code>best_ip_for</code> - determine the best IP address for the given "other" node, preferring local IP addresses over public ones.</li>
</ul>

<h4>
<a id="examples-7" class="anchor" href="#examples-7" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h4>

<div class="highlight highlight-ruby"><pre>redis <span class="pl-ko">=</span> search(<span class="pl-s1"><span class="pl-pds">'</span>node<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>role:redis<span class="pl-pds">'</span></span>).first

template <span class="pl-s1"><span class="pl-pds">'</span>/tmp/config<span class="pl-pds">'</span></span> <span class="pl-k">do</span>
  variables(
    <span class="pl-cos">ipaddress<span class="pl-pdc1">:</span></span> best_ip_for(redis)
  )
<span class="pl-k">end</span></pre></div>

<h3>
<a id="node" class="anchor" href="#node" aria-hidden="true"><span class="octicon octicon-link"></span></a>Node</h3>

<p>Additional methods for the <code>node</code> object</p>

<ul>
<li>
<code>deep_fetch</code> - safely fetch a nested attribute.</li>
<li>
<code>deep_fetch!</code> - fetch a nested attribute, raising a more semantic error if the key does not exist.</li>
<li>
<code>in?</code> - determine if the node is in the given Chef environment.</li>
</ul>

<h4>
<a id="examples-8" class="anchor" href="#examples-8" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h4>

<div class="highlight highlight-ruby"><pre>credentials <span class="pl-ko">=</span> <span class="pl-k">if</span> node.in?(<span class="pl-s1"><span class="pl-pds">'</span>production<span class="pl-pds">'</span></span>)
                <span class="pl-sc">Chef</span>::<span class="pl-sc">EncryptedDataBag</span>.<span class="pl-kos">new</span>(<span class="pl-s1"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>)
              <span class="pl-k">else</span>
                data_bag(<span class="pl-s1"><span class="pl-pds">'</span>...<span class="pl-pds">'</span></span>)
              <span class="pl-k">end</span></pre></div>

<div class="highlight highlight-ruby"><pre>node.deep_fetch(<span class="pl-s1"><span class="pl-pds">'</span>apache2<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>config<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>root<span class="pl-pds">'</span></span>) =&gt; node[<span class="pl-s1"><span class="pl-pds">'</span>apache2<span class="pl-pds">'</span></span>][<span class="pl-s1"><span class="pl-pds">'</span>config<span class="pl-pds">'</span></span>][<span class="pl-s1"><span class="pl-pds">'</span>root<span class="pl-pds">'</span></span>]</pre></div>

<h3>
<a id="platform" class="anchor" href="#platform" aria-hidden="true"><span class="octicon octicon-link"></span></a>Platform</h3>

<ul>
<li><code>amazon_linux?</code></li>
<li><code>centos?</code></li>
<li><code>linux_mint?</code></li>
<li><code>oracle_linux?</code></li>
<li><code>redhat_enterprise_linux?</code></li>
<li><code>scientific_linux?</code></li>
<li><code>ubuntu?</code></li>
<li><code>solaris2?</code></li>
<li><code>aix?</code></li>
<li><code>smartos?</code></li>
<li><code>omnios?</code></li>
</ul>

<p>There are also a series of dynamically defined matchers that map named operating system release versions and comparison operators in the form "#{platform}_#{operator}_#{name}?". For example:</p>

<ul>
<li><code>debian_after_squeeze?</code></li>
<li><code>linuxmint_after_or_at_olivia?</code></li>
<li><code>mac_os_x_lion?</code></li>
<li><code>ubuntu_before_lucid?</code></li>
<li><code>ubuntu_before_or_at_maverick?</code></li>
</ul>

<p>To get a full list, run the following in IRB:</p>

<div class="highlight highlight-ruby"><pre><span class="pl-mr"><span class="pl-kos">require</span> <span class="pl-s1"><span class="pl-pds">'</span>chef/sugar<span class="pl-pds">'</span></span></span>
puts <span class="pl-sc">Chef</span>::<span class="pl-sc">Sugar</span>::<span class="pl-sc">Platform</span>.instance_methods</pre></div>

<h4>
<a id="examples-9" class="anchor" href="#examples-9" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h4>

<div class="highlight highlight-ruby"><pre><span class="pl-k">if</span> ubuntu?
  execute <span class="pl-s1"><span class="pl-pds">'</span>apt-get update<span class="pl-pds">'</span></span>
<span class="pl-k">end</span></pre></div>

<h3>
<a id="platform-family" class="anchor" href="#platform-family" aria-hidden="true"><span class="octicon octicon-link"></span></a>Platform Family</h3>

<ul>
<li><code>arch_linux?</code></li>
<li><code>debian?</code></li>
<li><code>fedora?</code></li>
<li><code>freebsd?</code></li>
<li><code>gentoo?</code></li>
<li><code>linux?</code></li>
<li><code>mac_os_x?</code></li>
<li><code>openbsd?</code></li>
<li><code>rhel?</code></li>
<li><code>slackware?</code></li>
<li><code>suse?</code></li>
<li><code>windows?</code></li>
</ul>

<h4>
<a id="examples-10" class="anchor" href="#examples-10" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h4>

<div class="highlight highlight-ruby"><pre>node[<span class="pl-s1"><span class="pl-pds">'</span>attribute<span class="pl-pds">'</span></span>] <span class="pl-ko">=</span> <span class="pl-k">if</span> windows?
                      <span class="pl-s1"><span class="pl-pds">'</span>C:\Foo\BarDrive<span class="pl-pds">'</span></span>
                    <span class="pl-k">else</span>
                      <span class="pl-s1"><span class="pl-pds">'</span>/foo/bar_drive<span class="pl-pds">'</span></span>
                    <span class="pl-k">end</span></pre></div>

<h3>
<a id="ruby" class="anchor" href="#ruby" aria-hidden="true"><span class="octicon octicon-link"></span></a>Ruby</h3>

<p><strong>Note:</strong> The applies to the Ruby found at <code>node['languages']['ruby']</code>.</p>

<ul>
<li><code>ruby_20?</code></li>
<li><code>ruby_19?</code></li>
</ul>

<h4>
<a id="examples-11" class="anchor" href="#examples-11" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h4>

<div class="highlight highlight-ruby"><pre>log <span class="pl-s1"><span class="pl-pds">'</span>This has been known to fail on Ruby 2.0<span class="pl-pds">'</span></span> <span class="pl-k">if</span> ruby_20?</pre></div>

<h3>
<a id="run-context" class="anchor" href="#run-context" aria-hidden="true"><span class="octicon octicon-link"></span></a>Run Context</h3>

<ul>
<li>
<code>includes_recipe?</code> - determines if the current run context includes the recipe</li>
</ul>

<div class="highlight highlight-ruby"><pre><span class="pl-k">if</span> includes_recipe?(<span class="pl-s1"><span class="pl-pds">'</span>apache2::default<span class="pl-pds">'</span></span>)
  apache_module <span class="pl-s1"><span class="pl-pds">'</span>my_module<span class="pl-pds">'</span></span> <span class="pl-k">do</span>
    <span class="pl-c"><span class="pl-pdc">#</span> ...</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div>

<h3>
<a id="shell" class="anchor" href="#shell" aria-hidden="true"><span class="octicon octicon-link"></span></a>Shell</h3>

<ul>
<li><code>which</code></li>
<li><code>dev_null</code></li>
<li><code>installed?</code></li>
<li><code>installed_at_version?</code></li>
<li><code>version_for</code></li>
</ul>

<h4>
<a id="examples-12" class="anchor" href="#examples-12" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h4>

<div class="highlight highlight-ruby"><pre>log <span class="pl-s1"><span class="pl-pds">"</span>Using `mongo` at `<span class="pl-pse">#{</span><span class="pl-s2">which(<span class="pl-s1"><span class="pl-pds">'</span>mongo<span class="pl-pds">'</span></span>)</span><span class="pl-pse"><span class="pl-s2">}</span></span>`<span class="pl-pds">"</span></span>

<span class="pl-k">if</span> installed?(<span class="pl-s1"><span class="pl-pds">'</span>apt<span class="pl-pds">'</span></span>)
  execute <span class="pl-s1"><span class="pl-pds">'</span>apt-get update<span class="pl-pds">'</span></span>
<span class="pl-k">end</span>

execute <span class="pl-s1"><span class="pl-pds">'</span>install[thing]<span class="pl-pds">'</span></span> <span class="pl-k">do</span>
  command <span class="pl-s1"><span class="pl-pds">"</span>... 2&gt;&amp;1 <span class="pl-pse">#{</span><span class="pl-s2">dev_null</span><span class="pl-pse"><span class="pl-s2">}</span></span><span class="pl-pds">"</span></span>
  not_if  { installed_at_version?(<span class="pl-s1"><span class="pl-pds">'</span>thing<span class="pl-pds">'</span></span>, node[<span class="pl-s1"><span class="pl-pds">'</span>thing<span class="pl-pds">'</span></span>][<span class="pl-s1"><span class="pl-pds">'</span>version<span class="pl-pds">'</span></span>]) }
<span class="pl-k">end</span>

log <span class="pl-s1"><span class="pl-pds">"</span>Skipping git install, version is at <span class="pl-pse">#{</span><span class="pl-s2">version_for(<span class="pl-s1"><span class="pl-pds">'</span>mongo<span class="pl-pds">'</span></span>, <span class="pl-s1"><span class="pl-pds">'</span>-v<span class="pl-pds">'</span></span>)</span><span class="pl-pse"><span class="pl-s2">}</span></span><span class="pl-pds">"</span></span></pre></div>

<h3>
<a id="vagrant" class="anchor" href="#vagrant" aria-hidden="true"><span class="octicon octicon-link"></span></a>Vagrant</h3>

<ul>
<li><code>vagrant?</code></li>
</ul>

<h4>
<a id="examples-13" class="anchor" href="#examples-13" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h4>

<div class="highlight highlight-ruby"><pre>http_request <span class="pl-s1"><span class="pl-pds">'</span>http://...<span class="pl-pds">'</span></span> <span class="pl-k">do</span>
  not_if { vagrant? }
<span class="pl-k">end</span></pre></div>

<h3>
<a id="virtualization" class="anchor" href="#virtualization" aria-hidden="true"><span class="octicon octicon-link"></span></a>Virtualization</h3>

<ul>
<li><code>lxc?</code></li>
<li><code>vmware?</code></li>
</ul>

<h4>
<a id="examples-14" class="anchor" href="#examples-14" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h4>

<div class="highlight highlight-ruby"><pre>service <span class="pl-s1"><span class="pl-pds">'</span>ntpd<span class="pl-pds">'</span></span> <span class="pl-k">do</span>
  action [<span class="pl-cos"><span class="pl-pdc1">:</span>enable</span>, <span class="pl-cos"><span class="pl-pdc1">:</span>start</span>]
  not_if { lxc? }
<span class="pl-k">end</span></pre></div>

<h3>
<a id="filters" class="anchor" href="#filters" aria-hidden="true"><span class="octicon octicon-link"></span></a>Filters</h3>

<ul>
<li>
<code>compile_time</code> - accepts a block of resources to run at compile time</li>
<li>
<code>before</code> - insert resource in the collection before the given resource</li>
<li>
<code>after</code> - insert resource in the collection after the given resource</li>
</ul>

<h4>
<a id="examples-15" class="anchor" href="#examples-15" aria-hidden="true"><span class="octicon octicon-link"></span></a>Examples</h4>

<div class="highlight highlight-ruby"><pre>compile_time <span class="pl-k">do</span>
  package <span class="pl-s1"><span class="pl-pds">'</span>apache2<span class="pl-pds">'</span></span>
<span class="pl-k">end</span>

<span class="pl-c"><span class="pl-pdc">#</span> This is equivalent to</span>
package <span class="pl-s1"><span class="pl-pds">'</span>apache2<span class="pl-pds">'</span></span> <span class="pl-k">do</span>
  action <span class="pl-cos"><span class="pl-pdc1">:</span>nothing</span>
<span class="pl-k">end</span>.run_action(<span class="pl-cos"><span class="pl-pdc1">:</span>install</span>)</pre></div>

<div class="highlight highlight-ruby"><pre>before <span class="pl-s1"><span class="pl-pds">'</span>service[apache2]<span class="pl-pds">'</span></span> <span class="pl-k">do</span>
  log <span class="pl-s1"><span class="pl-pds">'</span>I am before the apache 2 service fires!<span class="pl-pds">'</span></span>
<span class="pl-k">end</span></pre></div>

<div class="highlight highlight-ruby"><pre>after <span class="pl-s1"><span class="pl-pds">'</span>service[apache2]<span class="pl-pds">'</span></span> <span class="pl-k">do</span>
  log <span class="pl-s1"><span class="pl-pds">'</span>I am after the apache 2 service fires!<span class="pl-pds">'</span></span>
<span class="pl-k">end</span></pre></div>

<h2>
<a id="license--authors" class="anchor" href="#license--authors" aria-hidden="true"><span class="octicon octicon-link"></span></a>License &amp; Authors</h2>

<ul>
<li>Author: Seth Vargo (<a href="mailto:sethvargo@gmail.com">sethvargo@gmail.com</a>)</li>
</ul>

<pre lang="text"><code>Copyright 2013-2014 Seth Vargo

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
</code></pre>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/sethvargo">sethvargo</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-12012976-11");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>